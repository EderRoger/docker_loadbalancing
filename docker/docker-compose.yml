node1:
  build: /vagrant/docker/nodes
  volumes: /var/log/nginx
  restart: always

node2:
  build: /vagrant/docker/nodes
  volumes: /var/log/nginx
  restart: always

haproxy:
  build: /vagrant/docker/haproxy
  restart: always
  links:
      - node1
      - node2
  expose:
    - "80"
    - "443"
  ports:
    - "80:80"
    - "443:443"

elasticsearch:
  image: elasticsearch
  expose:
   - "9300"
   - "9200"

logstash:
   image: logstash
   volumes: /logs:/tmp
   command: logstash -f /tmp/logstash.conf
   links:
    - elasticsearch
    - node1
    - node2
